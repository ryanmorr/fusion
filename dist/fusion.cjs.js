/*! @ryanmorr/fusion v0.1.0 | https://github.com/ryanmorr/fusion */'use strict';Object.defineProperty(exports,"__esModule",{value:!0});function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function unwrapExports(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a["default"]:a}function createCommonjsModule(a,b){return b={exports:{}},a(b,b.exports),b.exports}var createStore_esm=createCommonjsModule(function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=void 0;b["default"]=function(i){return function(){var j,k=[],a=function(){return j},c=function(){for(var b=arguments.length,c=Array(b),a=0;a<b;a++)c[a]=arguments[a];return j=c[0],k.slice().forEach(function(b){return b.apply(void 0,c)}),j},d=function(c){if(!k.includes(c))return k.push(c),c(j),function(){var a=k.indexOf(c);-1!==a&&k.splice(a,1)}},e=i(a,c,d,k),f=e.apply(void 0,arguments);return f.subscribe||(f.subscribe=d),f}}}),createStore=unwrapExports(createStore_esm),CSS=Symbol("css"),TYPE=Symbol("type"),val=createStore(function(a,b){return function(c){var d;b(c);var e=function(c){b(c,a())};return d={},_defineProperty(d,TYPE,"val"),_defineProperty(d,"get",a),_defineProperty(d,"set",e),_defineProperty(d,"update",function(b){e(b(a()))}),d}}),derived=createStore(function(a,b){return function(){for(var c,d=!1,e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];var h=f.pop(),j=[],k=function(){return b(h.apply(void 0,j),a())};return f.forEach(function(a,b){return a.subscribe(function(a){j[b]=a,d&&k()})}),d=!0,k(),(c={},_defineProperty(c,TYPE,"derived"),_defineProperty(c,"get",a),c)}});function uuid(){return Math.random().toString(36).substr(2,9)}function isStore(a){return a&&"function"==typeof a.subscribe}function isPromise(a){return Promise.resolve(a)===a}var docStyle=document.documentElement.style;function resolveValue(a){if(isStore(a)){if("val"===a[TYPE]||"derived"===a[TYPE])return"var(".concat(getProp(a),")");if("media"===a[TYPE])return"@media ".concat(a[CSS]);if("query"===a[TYPE])return a[CSS]}return isPromise(a)?"var(".concat(getProp(a),")"):a}function setProp(a,b){if(isPromise(b))return void b.then(function(b){return setProp(a,b)});var c=docStyle.getPropertyValue(a);""!==c&&null==b?docStyle.removeProperty(a):null!=b&&docStyle.setProperty(a,b)}function getProp(a){if(CSS in a)return a[CSS];var b="--".concat(uuid());return isStore(a)?a.subscribe(function(a){return setProp(b,a)}):a.then(function(a){return setProp(b,a)}),a[CSS]=b}function css(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=a.raw.reduce(function(a,b,d){return a+resolveValue(c[d-1])+b}),f=document.createElement("style");return f.appendChild(document.createTextNode(e)),f}function fallback(){for(var a=1,b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];var e=c.length;return c.reduce(function(b,c,d){return isStore(c)||isPromise(c)?(a++,b+="var(".concat(getProp(c))):"string"==typeof c&&c.startsWith("--")?(a++,b+="var(".concat(c)):b+=c,b+=d+1===e?Array(a).join(")"):", ",b},"")}var media=createStore(function(a,b){return function(c){var d,e=matchMedia(c),f=function(){return b(e.matches)};return"addEventListener"in e?e.addEventListener("change",f):e.addListener(f),f(),(d={},_defineProperty(d,TYPE,"media"),_defineProperty(d,CSS,c),_defineProperty(d,"get",a),d)}}),observer=null,listeners=[];function find(a){return Array.from(document.querySelectorAll(a))}function startObserver(){observer||(observer=new MutationObserver(checkSelectors),observer.observe(document.documentElement,{childList:!0,subtree:!0}))}function checkSelectors(){listeners.forEach(function(a){var b=a.selector,c=a.get,d=a.set,e=c(),f=find(b),g=f.filter(function(a){return!e.includes(a)}),h=e.filter(function(a){return!f.includes(a)});(0<g.length||0<h.length)&&d(f,e,g,h)})}var query=createStore(function(a,b){return function(c){var d;return startObserver(),listeners.push({selector:c,get:a,set:b}),b(find(c),[],[],[]),(d={},_defineProperty(d,TYPE,"query"),_defineProperty(d,CSS,c),_defineProperty(d,"get",a),d)}});exports.css=css,exports.derived=derived,exports.fallback=fallback,exports.media=media,exports.query=query,exports.val=val;
