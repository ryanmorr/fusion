/*! @ryanmorr/fusion v1.0.0 | https://github.com/ryanmorr/fusion */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).fusion={})}(this,(function(e){"use strict";
/*! @ryanmorr/isotope v3.1.0 | https://github.com/ryanmorr/isotope */class t{constructor(e){this._value=e,this._subscribers=[]}value(){return this._value}set(e){const t=this.value();if(e!==t)return this._value=e,this._subscribers.slice().forEach((n=>n(e,t))),e}subscribe(e){const t=this._subscribers;if(!t.includes(e))return t.push(e),e(this.value()),()=>{const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}then(e){e(this.value())}toString(){return String(this.value())}valueOf(){return this.value()}toJSON(){return this.value()}}let n=class extends t{update(e){return this.set(e(this.value()))}},r=class extends t{constructor(e,t){super();let n=!1;const r=[],s=()=>super.set(t(...r));e.forEach(((e,t)=>e.subscribe((e=>{r[t]=e,n&&s()})))),n=!0,s()}};class s extends t{constructor(e,t){super();let n=0,r=!1;const s=[],u=e=>t(...s.concat([e]));e.forEach(((e,t)=>e.subscribe((e=>{if(s[t]=e,r){n++;const e=n;u((t=>{n===e&&super.set(t)}))}})))),r=!0,u((e=>super.set(e)))}}r.prototype.set=void 0,s.prototype.set=void 0,class extends t{constructor(e,t){super(e),this._reducer=t}dispatch(e){return super.set(this._reducer(this.value(),e))}}.prototype.set=void 0;
/*! @ryanmorr/amble v0.1.2 | https://github.com/ryanmorr/amble */
const u=/([^{};]*)([;{}])/g,c=/(\r\n|\r|\n)+/g,o=/\t/g,i=/\s{2,}/g,l=/\/\*[\W\w]*?\*\//g,a=/\s*([:;{}])\s*/g,f=/\};+/g,h=/([^:;{}])}/g;class p extends t{constructor(e){super(),this.mq=matchMedia(e),this.mq.addEventListener("change",this.set.bind(this)),this.query=e,this.set()}set(){super.set(this.mq.matches)}}let d=null;const m=[];function y(e){return Array.from(document.querySelectorAll(e))}class v extends t{constructor(e){var t;super(y(e)),this.selector=e,t=this,d||(d=new MutationObserver((()=>m.forEach((e=>e.set())))),d.observe(document.documentElement,{childList:!0,subtree:!0})),m.push(t)}set(){const e=this.value(),t=y(this.selector);(t.filter((t=>!e.includes(t))).length>0||e.filter((e=>!t.includes(e))).length>0)&&super.set(t)}}function b(){return Math.random().toString(36).substring(2,11)}function g(e){return e&&"function"==typeof e.subscribe}function x(e){return e&&"function"==typeof e.then}function $(e,t,n){return e.raw.reduce(((e,r,s)=>e+n(t[s-1])+r))}const E=document.documentElement.style;function w(e,t){if("function"==typeof t)return w(e,t());if(x(t))return t.then((t=>w(e,t)));""!==E.getPropertyValue(e)&&null==t?E.removeProperty(e):null!=t&&E.setProperty(e,t)}function S(e){if("prop"in e)return e.prop;const t=`--${b()}`;return g(e)?e.subscribe((e=>w(t,e))):e.then((e=>w(t,e))),e.prop=t}let _;const q=/([\s\S]+,[\s\S]+)/m;function C(e){const t=[{children:[]}];let n=0;return function(e,t){e=function(e){return e.replace(c," ").replace(o," ").replace(i," ").replace(l,"").trim().replace(a,"$1").replace(f,"}").replace(h,"$1;}")}(e),u.lastIndex=0;for(let n;null!=(n=u.exec(e));)t(n[1],n[2])}(e,((e,r)=>{"{"==r?t[++n]={selector:e,rules:"",children:[]}:"}"==r?(t[n].rules+=e,t[--n].children.push(t.pop())):";"==r&&(t[n].rules+=e+r)})),t[0].children}function O(e,t){return e.reduce(((e,n)=>{let r=n.selector.trim();return"@"===r[0]?(e+=r+"{",n.children.length>0&&(e+=O(n.children,t)+"}")):(r=t&&"&"===r[0]?t+r.substring(1).replace(q,":is($1)"):t?t+" "+r.replace(q,":is($1)"):r.replace(q,":is($1)"),e+=r+"{"+n.rules+"}",n.children.length>0&&(e+=O(n.children,r))),e}),"")}function T(e){return O(C(e))}function k(e){return"function"==typeof e?k(e()):g(e)?e instanceof p?"@media "+e.query:e instanceof v?e.selector:`var(${S(e)})`:x(e)?`var(${S(e)})`:e&&1===e.nodeType&&"STYLE"===e.nodeName?e.textContent:e}function A(e){_||(_=document.createElement("style"),document.head.appendChild(_)),_.textContent+=e}function L(e){return"function"==typeof e?L(e()):g(e)?`var(${S(e)})`:e}e.css=function(e,...t){const n=$(e,t,k),r=document.createElement("style");return r.textContent+=T(n),r},e.derived=function(...e){const t=e.pop();return t.length>e.length?new s(e,t):new r(e,t)},e.fallback=function(...e){let t=1;const n=e.length,r=(e,s,u)=>"function"==typeof s?r(e,s(),u):(g(s)||x(s)?(t++,e+=`var(${S(s)}`):"string"==typeof s&&s.startsWith("--")?(t++,e+=`var(${s}`):e+=s,e+=u+1!==n?", ":Array(t).join(")"));return e.reduce(r,"")},e.keyframes=function(e,...t){const n="fusion-animation-"+b();return A(`@keyframes ${n} { ${$(e,t,L)} }`),n},e.media=function(e){return new p(e)},e.query=function(e){return new v(e)},e.store=function(e){return new n(e)},e.style=function(e,...t){const n=$(e,t,k),r="fusion-"+b();return A(T(`.${r} { ${n} }`)),r}}));
